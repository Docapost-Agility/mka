{"version":3,"sources":["webpack:///webpack/bootstrap 819a1e126e97e9afd78c","webpack:///./src/js/main.js"],"names":["mka","document","getElementById","Error","style","userSelect","mkarcmenuId","addEventListener","event","preventDefault","mkaEltSelected","getElementsByClassName","length","hasAttribute","newMenu","menu","JSON","parse","getAttribute","forEach","item","title","innerHTML","mkarcmenu","position","left","pageX","top","pageY","body","onmousedown","remove","zone","downX","downY","upX","upY","selectItem","ctrlKey","isClick","mkaElts","selectedItems","isAlreadySelected","Array","from","map","rect","elt","getBoundingClientRect","zoneElt","x1","offsetLeft","x2","width","y1","offsetTop","y2","height","classList","contains","add","push","drawSquare","node","createElement","id","appendChild","backgroundColor","deleteSquare","removeChild","orderCoordinate","refreshSquare","activeLasso","which","startLasso","onmousemove","window","onmouseup","onkeydown","e","code","selectedArray","last","console","log","previousElementSibling","nextElementSibling"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 819a1e126e97e9afd78c","// principal elt\nlet mka = document.getElementById(\"mka\");\n\nif (!mka) throw new Error('mka id not found');\n\n// on désactive la selection de text\nmka.style.userSelect = \"none\";\n\nconst mkarcmenuId = 'mkarcmenu'\n\n// On désactive le click droit sur l'élément principal\nmka.addEventListener('contextmenu', function (event) {\n    event.preventDefault();\n\n    let mkaEltSelected = document.getElementsByClassName('mka-elt-selected')\n    // Si suelement 1 élément est sélectionné et que il y a des items pour le menu\n    if (mkaEltSelected.length === 1 && mkaEltSelected[0].hasAttribute('mka-rc-menu-items')) {\n\n        let newMenu = '<div id=\"' + mkarcmenuId + '\"><ul>';\n\n        const menu = JSON.parse(mkaEltSelected[0].getAttribute('mka-rc-menu-items'));\n        menu.forEach(function (item) {\n            newMenu += '<li>' + item.title + '</li>';\n        });\n\n        newMenu += '</ul></div>';\n\n        mka.innerHTML += newMenu;\n\n        const mkarcmenu = document.getElementById(mkarcmenuId);\n\n        mkarcmenu.style.position = 'absolute';\n        mkarcmenu.style.left = event.pageX + 'px';\n        mkarcmenu.style.top = event.pageY + 'px';\n\n    }\n});\n\ndocument.body.onmousedown = () => {\n    if (document.getElementById(mkarcmenuId)) {\n        document.getElementById(mkarcmenuId).remove();\n    }\n};\n\nlet zone = {\n    downX: null,\n    downY: null,\n    upX: null,\n    upY: null,\n};\n\nlet selectItem = (ctrlKey, isClick) => {\n    let mkaElts = document.getElementsByClassName(\"mka-elt\");\n\n    let selectedItems = [];\n\n    let isAlreadySelected = false;\n\n    // on parcours chaque elt pour savoir s'ils sont dans la zone selectionné\n    Array.from(mkaElts).map(elt => {\n        let rect = elt.getBoundingClientRect();\n        let zoneElt = {\n            x1: elt.offsetLeft,\n            x2: (elt.offsetLeft + rect.width),\n            y1: elt.offsetTop,\n            y2: (elt.offsetTop + rect.height)\n        }\n        // Permet de savoir si la zone de l'elt croise la zone de selection \n        if (zone.x2 >= zoneElt.x1 && zoneElt.x2 >= zone.x1 && zone.y2 >= zoneElt.y1 && zoneElt.y2 >= zone.y1) {\n\n            // si pour le moment il n'y a pas de eu de déplacement\n            if (isClick && elt.classList.contains(\"mka-elt-selected\")) {\n                if (ctrlKey) {\n                    elt.classList.remove(\"mka-elt-selected\");\n                } else {\n                    elt.classList.add(\"mka-elt-selected\");\n                    selectedItems.push(elt);\n                }\n\n                // Le click a eu lieu sur un elt déjà sélectionné on retourn un boulean pour ne pas bind le moove\n                isAlreadySelected = true;\n            } else {\n                elt.classList.add(\"mka-elt-selected\");\n                selectedItems.push(elt);\n            }\n        } else {\n             // si la touche ctrl n'est pas appuyée on efface pas\n            if (!ctrlKey) {\n                elt.classList.remove(\"mka-elt-selected\");\n            }\n\n        }\n    });\n\n    document.getElementById(\"mka-count\").innerHTML = selectedItems.length;\n    return isAlreadySelected;\n};\n\n// we add div\nlet drawSquare = () => {\n    let node = document.createElement(\"div\");\n    node.id = \"selection\";\n    mka.appendChild(node);\n    node.style.position = \"absolute\";\n    node.style.backgroundColor = \"red\";\n    return node;\n};\n\nlet deleteSquare = () => {\n    let node = document.getElementById(\"selection\");\n    mka.removeChild(node);\n}\n\nlet orderCoordinate = () => {\n    // we order coordinate to simplify\n    zone.x1 = zone.downX;\n    zone.x2 = zone.upX;\n    zone.y1 = zone.downY;\n    zone.y2 = zone.upY;\n    // on part vers la gauche\n    if (zone.downX > zone.upX) {\n        zone.x1 = zone.upX;\n        zone.x2 = zone.downX;\n    }\n\n    // on part vers le haut\n    if (zone.downY > zone.upY) {\n        zone.y1 = zone.upY;\n        zone.y2 = zone.downY;\n    }\n}\n\nlet refreshSquare = (node) => {\n    node.style.top = zone.y1 + \"px\";\n    node.style.left = zone.x1 + \"px\";\n\n    node.style.width = (zone.x2 - zone.x1) + \"px\";\n    node.style.height = (zone.y2 - zone.y1) + \"px\";\n}\n\nlet activeLasso = () => {\n    // Lors de la pression sur la souris on bind l'action de déplacement\n    mka.onmousedown = (event) => {\n        // On démarre la sélection si on utilise le bouton gauche de la souris ou le clic droit\n        if (event.which === 1 || event.which === 3) {\n            // zone du click\n            zone.downX = event.pageX;\n            zone.downY = event.pageY;\n\n            let node = drawSquare();\n\n            let startLasso = (event, isClick) => {\n                zone.upX = event.pageX;\n                zone.upY = event.pageY;\n\n                orderCoordinate();\n                refreshSquare(node);\n\n                return selectItem(event.ctrlKey, isClick);\n            };\n            // on lance le lasso car il peut ne pas y avoir de mouve\n            let isAlreadySelected = startLasso(event, true);\n\n            // Si le down a lieu sur un elt déjà focus on ne peut pas déclancher le moove\n            // On démarre le lasso seulement si on utilise le bouton gauche de la souris\n            if (!isAlreadySelected && event.which === 1) {\n                document.body.onmousemove = (event) => {\n                    startLasso(event, false);\n                };\n            }\n        }\n    };\n\n    window.onmouseup = () => {\n        // Si on relache le cllic (gauche ou droit)\n        if (event.which === 1 || event.which === 3) {\n            // on unbind le mousemove\n            document.body.onmousemove = () => { };\n            // on supprime la selection\n            deleteSquare();\n        }\n    }\n}\n\ndocument.onkeydown = (e) => {\n    // On peut utiliser les touches du clavier seulement si le menu du click droit est fermé\n    if(!document.getElementById(mkarcmenuId)) {\n\n        let code = e.which;\n        if (code == 37 || code == 38 || code == 39 || code == 40) {\n\n            // on recupere le dernier elt selectionné dans le DOM\n            let selectedArray = document.getElementsByClassName(\"mka-elt-selected\");\n            let last = selectedArray[selectedArray.length - 1];\n\n            // si la touche ctrl n'est pas appuyée on efface pas\n            if (!event.ctrlKey) {\n                // on clean les éléments déjà sélectionné\n                let mkaElts = document.getElementsByClassName(\"mka-elt\");\n                Array.from(mkaElts).map(elt => { elt.classList.remove(\"mka-elt-selected\") });\n            }\n\n\n            switch (e.which) {\n                case 37: // left\n                    console.log(\"left\");\n                    break;\n\n                case 38: // up\n                    console.log(\"up\");\n                    last.previousElementSibling.classList.add(\"mka-elt-selected\");\n                    break;\n                case 39: // right\n                    console.log(\"right\");\n                    break;\n\n                case 40: // down\n                    last.nextElementSibling.classList.add(\"mka-elt-selected\");\n                    break;\n\n                default: return; // exit this handler for other keys\n            }\n        }\n\n    }\n}\n\nactiveLasso();\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/main.js"],"sourceRoot":""}